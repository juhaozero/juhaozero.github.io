<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="一些常用的配置文档说明, juhaozero的博客"><meta name="description" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="referrer" content="never"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>一些常用的配置文档说明 | juhaozero的博客</title><link rel="icon" type="image/png" href="/medias/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/materialize/1.0.0/css/materialize.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/aos/3.0.0-beta.6/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/lightgallery/1.6.12/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><meta name="generator" content="Hexo 5.4.2"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="juhaozero的博客" type="application/atom+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">juhaozero的博客</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于我</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">juhaozero的博客</div><div class="logo-desc">Never really desperate, only the lost of the soul.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于我</a></li><li><div class="divider"></div></li><li><a href="https://github.com/juhaozero" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/juhaozero" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/2.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">一些常用的配置文档说明</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{padding:35px 0 15px 17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{padding-bottom:30px;overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/%E5%85%B6%E4%BB%96/"><span class="chip bg-color">其他</span> </a><a href="/tags/%E6%97%A5%E5%B8%B8/"><span class="chip bg-color">日常</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%85%B6%E4%BB%96/" class="post-category">其他</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2023-01-17</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 8.4k</div></div></div><hr class="clearfix"><link rel="stylesheet" href="/libs/prism/prism.css"><div class="card-content article-card-content"><div id="articleContent"><blockquote><p>一些常用的配置文档说明</p></blockquote><h2 id="1-nginx命令配置"><a href="#1-nginx命令配置" class="headerlink" title="1. nginx命令配置"></a>1. nginx命令配置</h2><p>ngxin的模块实在是太多了，慢慢来吧，挑一些重要的讲 ;-)</p><ol><li><strong>核心配置</strong></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"> <span class="token comment">########   Nginx的main(全局配置)文件</span>
 <span class="token comment">#指定nginx运行的用户及用户组,默认为nobody</span>
user  nobody<span class="token punctuation">;</span>   
 
 <span class="token comment">#开启的线程数，一般跟逻辑CPU核数一致</span>
 worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>   
 
 <span class="token comment">#定位全局错误日志文件，级别以notice显示，还有debug,info,warn,error,crit模式，debug输出最多，crir输出最少，根据实际环境而定</span>
 <span class="token comment">#error_log  logs/error.log;</span>
<span class="token number">4</span> <span class="token comment">#error_log  logs/error.log  notice;</span>
 <span class="token comment">#error_log  logs/error.log  info;</span>
 
 <span class="token comment">#指定进程id的存储文件位置</span>
 <span class="token comment">#pid        logs/nginx.pid;</span>
 
 <span class="token comment">#指定一个nginx进程打开的最多文件描述符数目，受系统进程的最大打开文件数量限制</span>
 <span class="token comment">#worker_rlimit_nofile 65535</span>
 
 events <span class="token punctuation">{</span>
     <span class="token comment">#设置工作模式为epoll,除此之外还有select,poll,kqueue,rtsig和/dev/poll模式    #use epoll;</span>
     <span class="token comment">#定义每个进程的最大连接数,受系统进程的最大打开文件数量限制。</span>
     worker_connections  <span class="token number">1024</span>	<span class="token comment">#同时接受多个新网络连接请求的功	multi_accept on</span>
 <span class="token punctuation">}</span>
 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><p><strong>Http服务器配置</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#######Nginx的Http服务器配置,Gzip配置</span>
http <span class="token punctuation">{</span>
    <span class="token comment">#主模块指令，实现对配置文件所包含的文件的设定，可以减少主配置文件的复杂度，DNS主配置文件中的zonerfc1912,acl基本上都是用include语句。</span>
    include       mime.types<span class="token punctuation">;</span>
    
    <span class="token comment">#核心模块指令，智力默认设置为二进制流，也就是当文件类型未定义时使用这种方式</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    <span class="token comment">#下面代码为日志格式的设定，main为日志格式的名称，可自行设置，后面引用</span>
    <span class="token comment">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
    <span class="token comment">#                  '$status $body_bytes_sent "$http_referer" '</span>
    <span class="token comment">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span>

    <span class="token comment">#引用日志main</span>
    <span class="token comment">#access_log  logs/access.log  main;</span>

    <span class="token comment">#设置允许客户端请求的最大的单个文件字节数</span>
    <span class="token comment">#client_max_body_size 20M;</span>
    <span class="token comment">#指定来自客户端请求头的headebuffer大小</span>
    <span class="token comment">#client_header_buffer_size  32k;</span>
    <span class="token comment">#指定连接请求试图写入缓存文件的目录路径</span>
    <span class="token comment">#client_body_temp_path /dev/shm/client_body_temp;</span>
    <span class="token comment">#指定客户端请求中较大的消息头的缓存最大数量和大小，目前设置为4个32KB</span>
    <span class="token comment">#large client_header_buffers 4 32k;</span>
    
    <span class="token comment">#开启高效文件传输模式</span>
    sendfile        on<span class="token punctuation">;</span>
    <span class="token comment">#开启防止网络阻塞 /静态文件是 不要标志PUSH,而是等tcp缓冲满了，再发送</span>
    <span class="token comment">#tcp_nopush     on;</span>
    <span class="token comment">#开启防止网络阻塞/动态文件，立马发送。</span>
    <span class="token comment">#tcp_nodelay    on;</span>
    
 <span class="token comment">#设置客户端连接保存活动的超时时间  #keepalive_timeout  0; keepalive_timeout  65;</span>

<span class="token comment">#指定nginx与后端FastCGI server连接超时时	fastcgi_connect_timeout 60	#指定nginx向后端传送请求超时时	fastcgi_send_timeout 60	#指定nginx接受后端fastcgi响应请求超时时	fastcgi_read_timeout 60	#指定nginx读取fastcgi响应第一部分需要用多大的缓冲	fastcgi_buffer_size 4k|8	指nginx需要用多大的缓冲区缓冲fastcgi的应答请	fastcgi_buffers num size	8 4k|	#整个数据请求需要多大的缓存	fastcgi_busy_buffers 8k|16	</span>
 
    <span class="token comment">#设置客户端请求读取超时时间</span>
    <span class="token comment">#client_header_timeout 10;</span>
    <span class="token comment">#设置客户端请求主体读取超时时间</span>
    <span class="token comment">#client_body_timeout 10;</span>
    <span class="token comment">#用于设置相应客户端的超时时间</span>
    <span class="token comment">#send_timeout </span>
    
    <span class="token comment">####HttpGZip模块配置</span>
    <span class="token comment">#httpGzip modules</span>
    <span class="token comment">#开启gzip压缩</span>
    <span class="token comment">#gzip  on;</span>
    <span class="token comment">#设置允许压缩的页面最小字节数</span>
    <span class="token comment">#gzip_min_length 1k;</span>
    <span class="token comment">#申请4个单位为16K的内存作为压缩结果流缓存</span>
    <span class="token comment">#gzip_buffers 4 16k;</span>
    <span class="token comment">#设置识别http协议的版本，默认为1.1</span>
    <span class="token comment">#gzip_http_version 1.1;</span>
    <span class="token comment">#指定gzip压缩比，1-9数字越小，压缩比越小，速度越快</span>
    <span class="token comment">#gzip_comp_level 2;</span>
    <span class="token comment">#指定压缩的类型</span>
    <span class="token comment">#gzip_types text/plain application/x-javascript text/css application/xml;</span>
    <span class="token comment">#让前端的缓存服务器进过gzip压缩的页面</span>
    <span class="token comment">#gzip_vary on; 	#基于代理服务器的类型来决定是否进行压缩</span>
    <span class="token comment">#gzip_proxied   expired no-cache no-store private auth</span>
  
   

   <span class="token comment">#设定虚拟主机配置</span>
   server <span class="token punctuation">{</span>
       <span class="token comment">#侦听80端口</span>
       listen    <span class="token number">80</span><span class="token punctuation">;</span>
       <span class="token comment">#定义使用 www.nginx.cn访问</span>
       server_name  www.nginx.cn<span class="token punctuation">;</span>

       <span class="token comment">#定义服务器的默认网站根目录位置</span>
       root html<span class="token punctuation">;</span>

       <span class="token comment">#设定本虚拟主机的访问日志</span>
       access_log  logs/nginx.access.log  main<span class="token punctuation">;</span>

       <span class="token comment">#默认请求</span>
       location / <span class="token punctuation">{</span>
           <span class="token comment">#定义首页索引文件的名称</span>
           index index.php index.html index.htm<span class="token punctuation">;</span>   
   
       <span class="token punctuation">}</span>

       <span class="token comment"># 定义错误提示页面</span>
       error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span> /50x.html<span class="token punctuation">;</span>
       location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>
       <span class="token punctuation">}</span>

       <span class="token comment">#静态文件，nginx自己处理</span>
       location ~ ^/<span class="token punctuation">(</span>images<span class="token operator">|</span>javascript<span class="token operator">|</span>js<span class="token operator">|</span>css<span class="token operator">|</span>flash<span class="token operator">|</span>media<span class="token operator">|</span>static<span class="token punctuation">)</span>/ <span class="token punctuation">{</span>
           <span class="token comment">#过期30天，静态文件不怎么更新，过期可以设大一点，</span>
           <span class="token comment">#如果频繁更新，则可以设置得小一点。-1 为永远过期</span>
           expires 30d<span class="token punctuation">;</span>
       <span class="token punctuation">}</span>

       <span class="token comment">#禁止访问 .htxxx 文件</span>
           location ~ /.ht <span class="token punctuation">{</span>
           deny all<span class="token punctuation">;</span>
       <span class="token punctuation">}</span>

   <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><p><strong>反向代理配置</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#nginx的反向代理配置</span>
<span class="token comment">#proxy_pass：指定需要反向代理的服务器地址，可以是一个upstream池</span>
<span class="token comment">#proxy_next_upstream：如果后端服务器不可用的话自动将请求转发到另一台服务器，默认为on，还可以设置为timeout或者http状态码</span>
<span class="token comment">#proxy_method：修改用户的method请求</span>
<span class="token comment">#proxy_http_version：修改用户的http协议版本</span>
<span class="token comment">#proxy_set_header：修改用户header头部，如客户端真实IP信息，也是配置较多的选项</span>
<span class="token comment">#proxy_set_body：修改用户包体信息</span>
<span class="token comment">#proxy_send_timeout：默认60S</span>
<span class="token comment">#proxy_connect_timeout：默认60S，Nginx与后端服务器连接超时时间</span>

<span class="token comment">#定义一个upstream池</span>
upstream name <span class="token punctuation">{</span>
  ip_hash<span class="token punctuation">;</span><span class="token comment"># 负载均衡指令 （hash,ip_hash,least_conn,stickty,哈希,根据iphash,最小请求原则，cookie分布)</span>
  server   backend1.example.com<span class="token punctuation">;</span>
  server   backend2.example.com<span class="token punctuation">;</span>
  server   backend3.example.com  
  server   backend4.example.com<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
		
		
		location /test <span class="token punctuation">{</span>
        proxy_pass http://test<span class="token punctuation">;</span>
        proxy_http_version <span class="token number">1.1</span><span class="token punctuation">;</span>
		proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
        proxy_set_header Connection <span class="token variable">$connection_upgrade</span><span class="token punctuation">;</span>
        proxy_read_timeout 30s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li><p><strong>SSL证书配置</strong></p><p>证书的话要安装模块</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./nginx <span class="token parameter variable">-V</span>  
如果出现 <span class="token punctuation">(</span>configure arguments: --with-http_ssl_module<span class="token punctuation">)</span>, 则已安装
进入nginx目录,安装模块
./configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module
编译
<span class="token function">make</span> 
上述操作执行完成以后，你的目录下会出现objs文件夹,进入目录，找到二进制nginx文件替换当前二进制文件即可<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">{</span>
    listen <span class="token number">80</span><span class="token punctuation">;</span>
    server_name www.nginx.cn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">#nginx的证书配置</span>
<span class="token comment">#listen：开启ssl模块,监听443端口，https端口443</span>
<span class="token comment">#server_name：绑定证书的域名</span>
<span class="token comment">#ssl_certificate：证书文件的相对路径或绝对路径</span>
<span class="token comment">#ssl_certificate_key：私钥文件的相对路径或绝对路径</span>
<span class="token comment">#ssl_session_timeout ：超时时间</span>
<span class="token comment">#ssl_protocols：启用指定的加密协议</span>
<span class="token comment">#ssl_ciphers ：加密算法</span>
<span class="token comment">#ssl_prefer_server_ciphers：使用服务器端的首选算法</span>

server<span class="token punctuation">{</span>
    listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>
    server_name www.nginx.cn<span class="token punctuation">;</span>
    ssl_certificate /etc/nginx/ssl.conf/lebang2020.cn.pem<span class="token punctuation">;</span>
    ssl_certificate_key /etc/nginx/ssl.conf/lebang2020.cn.key<span class="token punctuation">;</span>
    ssl_session_timeout 5m<span class="token punctuation">;</span>
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2<span class="token punctuation">;</span>
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:<span class="token operator">!</span>aNULL:<span class="token operator">!</span>MD5:<span class="token operator">!</span>RC4:<span class="token operator">!</span>DHE<span class="token punctuation">;</span>
    ssl_prefer_server_ciphers on<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li><p><strong>nginx中设置Ip黑名单</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/nginx/conf.d/ip.conf

deny <span class="token number">127.0</span>.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ol></li></ol></li></ol><h2 id="2-redis-配置文件"><a href="#2-redis-配置文件" class="headerlink" title="2. redis 配置文件"></a>2. redis 配置文件</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Redis 配置文件示例</span>

<span class="token comment"># 注意单位: 当需要配置内存大小时, 可能需要指定像1k,5GB,4M等常见格式</span>
<span class="token comment">#</span>
<span class="token comment"># 1k =&gt; 1000 bytes</span>
<span class="token comment"># 1kb =&gt; 1024 bytes</span>
<span class="token comment"># 1m =&gt; 1000000 bytes</span>
<span class="token comment"># 1mb =&gt; 1024*1024 bytes</span>
<span class="token comment"># 1g =&gt; 1000000000 bytes</span>
<span class="token comment"># 1gb =&gt; 1024*1024*1024 bytes</span>
<span class="token comment">#</span>
<span class="token comment"># 单位是对大小写不敏感的 1GB 1Gb 1gB 是相同的。</span>

<span class="token comment">################################## INCLUDES ###################################</span>

<span class="token comment"># 可以在这里包含一个或多个其他的配置文件。如果你有一个适用于所有Redis服务器的标准配置模板</span>
<span class="token comment"># 但也需要一些每个服务器自定义的设置，这个功能将很有用。被包含的配置文件也可以包含其他配置文件，</span>
<span class="token comment"># 所以需要谨慎的使用这个功能。</span>
<span class="token comment">#</span>
<span class="token comment"># 注意“inclue”选项不能被admin或Redis哨兵的"CONFIG REWRITE"命令重写。</span>
<span class="token comment"># 因为Redis总是使用最后解析的配置行最为配置指令的值, 你最好在这个文件的开头配置includes来</span>
<span class="token comment"># 避免它在运行时重写配置。</span>
<span class="token comment"># 如果相反你想用includes的配置覆盖原来的配置，你最好在该文件的最后使用include</span>
<span class="token comment">#</span>
<span class="token comment"># include /path/to/local.conf</span>
<span class="token comment"># include /path/to/other.conf</span>

<span class="token comment">################################ GENERAL  #####################################</span>

<span class="token comment"># 默认Rdis不会作为守护进程运行。如果需要的话配置成'yes'</span>
<span class="token comment"># 注意配置成守护进程后Redis会将进程号写入文件/var/run/redis.pid</span>
daemonize no

<span class="token comment"># 当以守护进程方式运行时，默认Redis会把进程ID写到 /var/run/redis.pid。你可以在这里修改路径。</span>
pidfile /var/run/redis.pid

<span class="token comment"># 接受连接的特定端口，默认是6379</span>
<span class="token comment"># 如果端口设置为0，Redis就不会监听TCP套接字。</span>
port <span class="token number">6379</span>

<span class="token comment"># TCP listen() backlog.</span>
<span class="token comment">#</span>
<span class="token comment"># 在高并发环境下你需要一个高backlog值来避免慢客户端连接问题。注意Linux内核默默地将这个值减小</span>
<span class="token comment"># 到/proc/sys/net/core/somaxconn的值，所以需要确认增大somaxconn和tcp_max_syn_backlog</span>
<span class="token comment"># 两个值来达到想要的效果。</span>
tcp-backlog <span class="token number">511</span>

<span class="token comment"># 默认Redis监听服务器上所有可用网络接口的连接。可以用"bind"配置指令跟一个或多个ip地址来实现</span>
<span class="token comment"># 监听一个或多个网络接口</span>
<span class="token comment">#</span>
<span class="token comment"># 示例:</span>
<span class="token comment">#</span>
<span class="token comment"># bind 192.168.1.100 10.0.0.1</span>
<span class="token comment"># bind 127.0.0.1</span>

<span class="token comment"># 指定用来监听Unix套套接字的路径。没有默认值， 所以在没有指定的情况下Redis不会监听Unix套接字</span>
<span class="token comment">#</span>
<span class="token comment"># unixsocket /tmp/redis.sock</span>
<span class="token comment"># unixsocketperm 755</span>

<span class="token comment"># 一个客户端空闲多少秒后关闭连接。(0代表禁用，永不关闭)</span>
<span class="token function">timeout</span> <span class="token number">0</span>

<span class="token comment"># TCP keepalive.</span>
<span class="token comment">#</span>
<span class="token comment"># 如果非零，则设置SO_KEEPALIVE选项来向空闲连接的客户端发送ACK，由于以下两个原因这是很有用的：</span>
<span class="token comment">#</span>
<span class="token comment"># 1）能够检测无响应的对端</span>
<span class="token comment"># 2）让该连接中间的网络设备知道这个连接还存活</span>
<span class="token comment">#</span>
<span class="token comment"># 在Linux上，这个指定的值(单位：秒)就是发送ACK的时间间隔。</span>
<span class="token comment"># 注意：要关闭这个连接需要两倍的这个时间值。</span>
<span class="token comment"># 在其他内核上这个时间间隔由内核配置决定</span>
<span class="token comment">#</span>
<span class="token comment"># 这个选项的一个合理值是60秒</span>
tcp-keepalive <span class="token number">0</span>

<span class="token comment"># 指定服务器调试等级</span>
<span class="token comment"># 可能值：</span>
<span class="token comment"># debug （大量信息，对开发/测试有用）</span>
<span class="token comment"># verbose （很多精简的有用信息，但是不像debug等级那么多）</span>
<span class="token comment"># notice （适量的信息，基本上是你生产环境中需要的）</span>
<span class="token comment"># warning （只有很重要/严重的信息会记录下来）</span>
loglevel notice

<span class="token comment"># 指明日志文件名。也可以使用"stdout"来强制让Redis把日志信息写到标准输出上。</span>
<span class="token comment"># 注意:如果Redis以守护进程方式运行，而设置日志显示到标准输出的话，日志会发送到/dev/null</span>
logfile <span class="token string">""</span>

<span class="token comment"># 要使用系统日志记录器，只要设置 "syslog-enabled" 为 "yes" 就可以了。</span>
<span class="token comment"># 然后根据需要设置其他一些syslog参数就可以了。</span>
<span class="token comment"># syslog-enabled no</span>

<span class="token comment"># 指明syslog身份</span>
<span class="token comment"># syslog-ident redis</span>

<span class="token comment"># 指明syslog的设备。必须是user或LOCAL0 ~ LOCAL7之一。</span>
<span class="token comment"># syslog-facility local0</span>

<span class="token comment"># 设置数据库个数。默认数据库是 DB 0，</span>
<span class="token comment"># 可以通过select &lt;dbid&gt;  (0 &lt;= dbid &lt;= 'databases' - 1 ）来为每个连接使用不同的数据库。</span>
databases <span class="token number">16</span>

<span class="token comment">################################ SNAPSHOTTING  ################################</span>
<span class="token comment">#</span>
<span class="token comment"># 把数据库存到磁盘上:</span>
<span class="token comment">#</span>
<span class="token comment">#   save &lt;seconds&gt; &lt;changes&gt;</span>
<span class="token comment">#   </span>
<span class="token comment">#   会在指定秒数和数据变化次数之后把数据库写到磁盘上。</span>
<span class="token comment">#</span>
<span class="token comment">#   下面的例子将会进行把数据写入磁盘的操作:</span>
<span class="token comment">#   900秒（15分钟）之后，且至少1次变更</span>
<span class="token comment">#   300秒（5分钟）之后，且至少10次变更</span>
<span class="token comment">#   60秒之后，且至少10000次变更</span>
<span class="token comment">#</span>
<span class="token comment">#   注意：你要想不写磁盘的话就把所有 "save" 设置注释掉就行了。</span>
<span class="token comment">#</span>
<span class="token comment">#   通过添加一条带空字符串参数的save指令也能移除之前所有配置的save指令</span>
<span class="token comment">#   像下面的例子：</span>
<span class="token comment">#   save "" </span>

save <span class="token number">900</span> <span class="token number">1</span>
save <span class="token number">300</span> <span class="token number">10</span>
save <span class="token number">60</span> <span class="token number">10000</span>

<span class="token comment"># 默认如果开启RDB快照(至少一条save指令)并且最新的后台保存失败，Redis将会停止接受写操作</span>
<span class="token comment"># 这将使用户知道数据没有正确的持久化到硬盘，否则可能没人注意到并且造成一些灾难。</span>
<span class="token comment">#</span>
<span class="token comment"># 如果后台保存进程能重新开始工作，Redis将自动允许写操作</span>
<span class="token comment">#</span>
<span class="token comment"># 然而如果你已经部署了适当的Redis服务器和持久化的监控，你可能想关掉这个功能以便于即使是</span>
<span class="token comment"># 硬盘，权限等出问题了Redis也能够像平时一样正常工作，</span>
stop-writes-on-bgsave-error <span class="token function">yes</span>

<span class="token comment"># 当导出到 .rdb 数据库时是否用LZF压缩字符串对象？</span>
<span class="token comment"># 默认设置为 "yes"，因为几乎在任何情况下它都是不错的。</span>
<span class="token comment"># 如果你想节省CPU的话你可以把这个设置为 "no"，但是如果你有可压缩的key和value的话，</span>
<span class="token comment"># 那数据文件就会更大了。</span>
rdbcompression <span class="token function">yes</span>

<span class="token comment"># 因为版本5的RDB有一个CRC64算法的校验和放在了文件的最后。这将使文件格式更加可靠但在</span>
<span class="token comment"># 生产和加载RDB文件时，这有一个性能消耗(大约10%)，所以你可以关掉它来获取最好的性能。</span>
<span class="token comment">#</span>
<span class="token comment"># 生成的关闭校验的RDB文件有一个0的校验和，它将告诉加载代码跳过检查</span>
rdbchecksum <span class="token function">yes</span>

<span class="token comment"># 持久化数据库的文件名</span>
dbfilename dump.rdb

<span class="token comment"># 工作目录</span>
<span class="token comment">#</span>
<span class="token comment"># 数据库会写到这个目录下，文件名就是上面的 "dbfilename" 的值。</span>
<span class="token comment"># </span>
<span class="token comment"># 累加文件也放这里。</span>
<span class="token comment"># </span>
<span class="token comment"># 注意你这里指定的必须是目录，不是文件名。</span>
<span class="token function">dir</span> ./

<span class="token comment">################################# REPLICATION #################################</span>
<span class="token comment"># 主从同步。通过 slaveof 指令来实现Redis实例的备份。</span>
<span class="token comment"># 注意，这里是本地从远端复制数据。也就是说，本地可以有不同的数据库文件、绑定不同的IP、监听</span>
<span class="token comment"># 不同的端口。</span>
<span class="token comment">#</span>
<span class="token comment"># slaveof &lt;masterip&gt; &lt;masterport&gt;</span>

<span class="token comment"># 如果master设置了密码保护（通过 "requirepass" 选项来配置），那么slave在开始同步之前必须</span>
<span class="token comment"># 进行身份验证，否则它的同步请求会被拒绝。</span>
<span class="token comment">#</span>
<span class="token comment"># masterauth &lt;master-password&gt;</span>

<span class="token comment"># 当一个slave失去和master的连接，或者同步正在进行中，slave的行为有两种可能：</span>
<span class="token comment">#</span>
<span class="token comment"># 1) 如果 slave-serve-stale-data 设置为 "yes" (默认值)，slave会继续响应客户端请求，</span>
<span class="token comment">#    可能是正常数据，也可能是还没获得值的空数据。</span>
<span class="token comment"># 2) 如果 slave-serve-stale-data 设置为 "no"，slave会回复"正在从master同步</span>
<span class="token comment">#   （SYNC with master in progress）"来处理各种请求，除了 INFO 和 SLAVEOF 命令。</span>
<span class="token comment">#</span>
slave-serve-stale-data <span class="token function">yes</span>

<span class="token comment"># 你可以配置salve实例是否接受写操作。可写的slave实例可能对存储临时数据比较有用(因为写入salve</span>
<span class="token comment"># 的数据在同master同步之后将很容被删除)，但是如果客户端由于配置错误在写入时也可能产生一些问题。</span>
<span class="token comment">#</span>
<span class="token comment"># 从Redis2.6默认所有的slave为只读</span>
<span class="token comment">#</span>
<span class="token comment"># 注意:只读的slave不是为了暴露给互联网上不可信的客户端而设计的。它只是一个防止实例误用的保护层。</span>
<span class="token comment"># 一个只读的slave支持所有的管理命令比如config,debug等。为了限制你可以用'rename-command'来</span>
<span class="token comment"># 隐藏所有的管理和危险命令来增强只读slave的安全性</span>
slave-read-only <span class="token function">yes</span>

<span class="token comment"># slave根据指定的时间间隔向master发送ping请求。</span>
<span class="token comment"># 时间间隔可以通过 repl_ping_slave_period 来设置。</span>
<span class="token comment"># 默认10秒。</span>
<span class="token comment">#</span>
<span class="token comment"># repl-ping-slave-period 10</span>

<span class="token comment"># 以下选项设置同步的超时时间</span>
<span class="token comment">#</span>
<span class="token comment"># 1）slave在与master SYNC期间有大量数据传输，造成超时</span>
<span class="token comment"># 2）在slave角度，master超时，包括数据、ping等</span>
<span class="token comment"># 3）在master角度，slave超时，当master发送REPLCONF ACK pings</span>
<span class="token comment"># </span>
<span class="token comment"># 确保这个值大于指定的repl-ping-slave-period，否则在主从间流量不高时每次都会检测到超时</span>
<span class="token comment">#</span>
<span class="token comment"># repl-timeout 60</span>

<span class="token comment"># 是否在slave套接字发送SYNC之后禁用 TCP_NODELAY ？</span>
<span class="token comment">#</span>
<span class="token comment"># 如果你选择“yes”Redis将使用更少的TCP包和带宽来向slaves发送数据。但是这将使数据传输到slave</span>
<span class="token comment"># 上有延迟，Linux内核的默认配置会达到40毫秒</span>
<span class="token comment">#</span>
<span class="token comment"># 如果你选择了 "no" 数据传输到salve的延迟将会减少但要使用更多的带宽</span>
<span class="token comment">#</span>
<span class="token comment"># 默认我们会为低延迟做优化，但高流量情况或主从之间的跳数过多时，把这个选项设置为“yes”</span>
<span class="token comment"># 是个不错的选择。</span>
repl-disable-tcp-nodelay no

<span class="token comment"># 设置数据备份的backlog大小。backlog是一个slave在一段时间内断开连接时记录salve数据的缓冲，</span>
<span class="token comment"># 所以一个slave在重新连接时，不必要全量的同步，而是一个增量同步就足够了，将在断开连接的这段</span>
<span class="token comment"># 时间内slave丢失的部分数据传送给它。</span>
<span class="token comment">#</span>
<span class="token comment"># 同步的backlog越大，slave能够进行增量同步并且允许断开连接的时间就越长。</span>
<span class="token comment">#</span>
<span class="token comment"># backlog只分配一次并且至少需要一个slave连接</span>
<span class="token comment">#</span>
<span class="token comment"># repl-backlog-size 1mb</span>

<span class="token comment"># 当master在一段时间内不再与任何slave连接，backlog将会释放。以下选项配置了从最后一个</span>
<span class="token comment"># slave断开开始计时多少秒后，backlog缓冲将会释放。</span>
<span class="token comment">#</span>
<span class="token comment"># 0表示永不释放backlog</span>
<span class="token comment">#</span>
<span class="token comment"># repl-backlog-ttl 3600</span>

<span class="token comment"># slave的优先级是一个整数展示在Redis的Info输出中。如果master不再正常工作了，哨兵将用它来</span>
<span class="token comment"># 选择一个slave提升=升为master。</span>
<span class="token comment">#</span>
<span class="token comment"># 优先级数字小的salve会优先考虑提升为master，所以例如有三个slave优先级分别为10，100，25，</span>
<span class="token comment"># 哨兵将挑选优先级最小数字为10的slave。</span>
<span class="token comment">#</span>
<span class="token comment"># 0作为一个特殊的优先级，标识这个slave不能作为master，所以一个优先级为0的slave永远不会被</span>
<span class="token comment"># 哨兵挑选提升为master</span>
<span class="token comment">#</span>
<span class="token comment"># 默认优先级为100</span>
slave-priority <span class="token number">100</span>

<span class="token comment"># 如果master少于N个延时小于等于M秒的已连接slave，就可以停止接收写操作。</span>
<span class="token comment">#</span>
<span class="token comment"># N个slave需要是“oneline”状态</span>
<span class="token comment">#</span>
<span class="token comment"># 延时是以秒为单位，并且必须小于等于指定值，是从最后一个从slave接收到的ping（通常每秒发送）</span>
<span class="token comment"># 开始计数。</span>
<span class="token comment">#</span>
<span class="token comment"># This option does not GUARANTEES that N replicas will accept the write, but</span>
<span class="token comment"># will limit the window of exposure for lost writes in case not enough slaves</span>
<span class="token comment"># are available, to the specified number of seconds.</span>
<span class="token comment">#</span>
<span class="token comment"># 例如至少需要3个延时小于等于10秒的slave用下面的指令：</span>
<span class="token comment">#</span>
<span class="token comment"># min-slaves-to-write 3</span>
<span class="token comment"># min-slaves-max-lag 10</span>
<span class="token comment">#</span>
<span class="token comment"># 两者之一设置为0将禁用这个功能。</span>
<span class="token comment">#</span>
<span class="token comment"># 默认 min-slaves-to-write 值是0（该功能禁用）并且 min-slaves-max-lag 值是10。</span>

<span class="token comment">################################## SECURITY ###################################</span>

<span class="token comment"># 要求客户端在处理任何命令时都要验证身份和密码。</span>
<span class="token comment"># 这个功能在有你不信任的其它客户端能够访问redis服务器的环境里非常有用。</span>
<span class="token comment">#</span>

<span class="token comment"># 为了向后兼容的话这段应该注释掉。而且大多数人不需要身份验证(例如:它们运行在自己的服务器上)</span>
<span class="token comment"># </span>
<span class="token comment"># 警告：因为Redis太快了，所以外面的人可以尝试每秒150k的密码来试图破解密码。这意味着你需要</span>
<span class="token comment"># 一个高强度的密码，否则破解太容易了。</span>
<span class="token comment">#</span>
<span class="token comment"># requirepass foobared</span>

<span class="token comment"># 命令重命名</span>
<span class="token comment">#</span>
<span class="token comment"># 在共享环境下，可以为危险命令改变名字。比如，你可以为 CONFIG 改个其他不太容易猜到的名字，</span>
<span class="token comment"># 这样内部的工具仍然可以使用，而普通的客户端将不行。</span>
<span class="token comment">#</span>
<span class="token comment"># 例如：</span>
<span class="token comment">#</span>
<span class="token comment"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span>
<span class="token comment">#</span>
<span class="token comment"># 也可以通过改名为空字符串来完全禁用一个命令</span>
<span class="token comment">#</span>
<span class="token comment"># rename-command CONFIG ""</span>
<span class="token comment">#</span>
<span class="token comment"># 请注意：改变命令名字被记录到AOF文件或被传送到从服务器可能产生问题。</span>

<span class="token comment">################################### LIMITS ####################################</span>

<span class="token comment"># 设置最多同时连接的客户端数量。默认这个限制是10000个客户端，然而如果Redis服务器不能配置</span>
<span class="token comment"># 处理文件的限制数来满足指定的值，那么最大的客户端连接数就被设置成当前文件限制数减32（因</span>
<span class="token comment"># 为Redis服务器保留了一些文件描述符作为内部使用）</span>
<span class="token comment">#</span>
<span class="token comment"># 一旦达到这个限制，Redis会关闭所有新连接并发送错误'max number of clients reached'</span>
<span class="token comment">#</span>
<span class="token comment"># maxclients 10000</span>

<span class="token comment"># 不要用比设置的上限更多的内存。一旦内存使用达到上限，Redis会根据选定的回收策略（参见：</span>
<span class="token comment"># maxmemmory-policy）删除key</span>
<span class="token comment">#</span>
<span class="token comment"># 如果因为删除策略Redis无法删除key，或者策略设置为 "noeviction"，Redis会回复需要更</span>
<span class="token comment"># 多内存的错误信息给命令。例如，SET,LPUSH等等，但是会继续响应像Get这样的只读命令。</span>
<span class="token comment">#</span>
<span class="token comment"># 在使用Redis作为LRU缓存，或者为实例设置了硬性内存限制的时候（使用 "noeviction" 策略）</span>
<span class="token comment"># 的时候，这个选项通常事很有用的。</span>
<span class="token comment">#</span>
<span class="token comment"># 警告：当有多个slave连上达到内存上限的实例时，master为同步slave的输出缓冲区所需</span>
<span class="token comment"># 内存不计算在使用内存中。这样当驱逐key时，就不会因网络问题 / 重新同步事件触发驱逐key</span>
<span class="token comment"># 的循环，反过来slaves的输出缓冲区充满了key被驱逐的DEL命令，这将触发删除更多的key，</span>
<span class="token comment"># 直到这个数据库完全被清空为止</span>
<span class="token comment"># </span>
<span class="token comment"># 总之...如果你需要附加多个slave，建议你设置一个稍小maxmemory限制，这样系统就会有空闲</span>
<span class="token comment"># 的内存作为slave的输出缓存区(但是如果最大内存策略设置为"noeviction"的话就没必要了)</span>
<span class="token comment">#</span>
<span class="token comment"># maxmemory &lt;bytes&gt;</span>

<span class="token comment"># 最大内存策略：如果达到内存限制了，Redis如何选择删除key。你可以在下面五个行为里选：</span>
<span class="token comment"># </span>
<span class="token comment"># volatile-lru -&gt; 根据LRU算法生成的过期时间来删除。</span>
<span class="token comment"># allkeys-lru -&gt; 根据LRU算法删除任何key。</span>
<span class="token comment"># volatile-random -&gt; 根据过期设置来随机删除key。 </span>
<span class="token comment"># allkeys-&gt;random -&gt; 无差别随机删。 </span>
<span class="token comment"># volatile-ttl -&gt; 根据最近过期时间来删除（辅以TTL） </span>
<span class="token comment"># noeviction -&gt; 谁也不删，直接在写操作时返回错误。</span>
<span class="token comment"># </span>
<span class="token comment"># 注意：对所有策略来说，如果Redis找不到合适的可以删除的key都会在写操作时返回一个错误。</span>
<span class="token comment">#</span>

<span class="token comment">#       目前为止涉及的命令：set setnx setex append</span>
<span class="token comment">#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd</span>
<span class="token comment">#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby</span>
<span class="token comment">#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby</span>
<span class="token comment">#       getset mset msetnx exec sort</span>
<span class="token comment">#</span>

<span class="token comment"># 默认值如下：</span>
<span class="token comment">#</span>
<span class="token comment"># maxmemory-policy volatile-lru</span>

<span class="token comment"># LRU和最小TTL算法的实现都不是很精确，但是很接近（为了省内存），所以你可以用样本量做检测。</span>
<span class="token comment"># 例如：默认Redis会检查3个key然后取最旧的那个，你可以通过下面的配置指令来设置样本的个数。</span>
<span class="token comment">#</span>
<span class="token comment"># maxmemory-samples 3</span>

<span class="token comment">############################## APPEND ONLY MODE ###############################</span>

<span class="token comment"># 默认情况下，Redis是异步的把数据导出到磁盘上。这种模式在很多应用里已经足够好，但Redis进程</span>
<span class="token comment"># 出问题或断电时可能造成一段时间的写操作丢失(这取决于配置的save指令)。</span>
<span class="token comment">#</span>
<span class="token comment"># AOF是一种提供了更可靠的替代持久化模式，例如使用默认的数据写入文件策略（参见后面的配置）</span>
<span class="token comment"># 在遇到像服务器断电或单写情况下Redis自身进程出问题但操作系统仍正常运行等突发事件时，Redis</span>
<span class="token comment"># 能只丢失1秒的写操作。</span>
<span class="token comment">#</span>
<span class="token comment"># AOF和RDB持久化能同时启动并且不会有问题。</span>
<span class="token comment"># 如果AOF开启，那么在启动时Redis将加载AOF文件，它更能保证数据的可靠性。</span>
<span class="token comment">#</span>
<span class="token comment"># 请查看 http://redis.io/topics/persistence 来获取更多信息.</span>

appendonly no

<span class="token comment"># 纯累加文件名字（默认："appendonly.aof"）</span>

appendfilename <span class="token string">"appendonly.aof"</span>

<span class="token comment"># fsync() 系统调用告诉操作系统把数据写到磁盘上，而不是等更多的数据进入输出缓冲区。</span>
<span class="token comment"># 有些操作系统会真的把数据马上刷到磁盘上；有些则会尽快去尝试这么做。</span>
<span class="token comment">#</span>
<span class="token comment"># Redis支持三种不同的模式：</span>
<span class="token comment">#</span>
<span class="token comment"># no：不要立刻刷，只有在操作系统需要刷的时候再刷。比较快。</span>
<span class="token comment"># always：每次写操作都立刻写入到aof文件。慢，但是最安全。</span>
<span class="token comment"># everysec：每秒写一次。折中方案。 </span>
<span class="token comment">#</span>
<span class="token comment"># 默认的 "everysec" 通常来说能在速度和数据安全性之间取得比较好的平衡。根据你的理解来</span>
<span class="token comment"># 决定，如果你能放宽该配置为"no" 来获取更好的性能(但如果你能忍受一些数据丢失，可以考虑使用</span>
<span class="token comment"># 默认的快照持久化模式)，或者相反，用“always”会比较慢但比everysec要更安全。</span>
<span class="token comment">#</span>
<span class="token comment"># 请查看下面的文章来获取更多的细节</span>
<span class="token comment"># http://antirez.com/post/redis-persistence-demystified.html </span>
<span class="token comment"># </span>
<span class="token comment"># 如果不能确定，就用 "everysec"</span>

<span class="token comment"># appendfsync always</span>
appendfsync everysec
<span class="token comment"># appendfsync no</span>

<span class="token comment"># 如果AOF的同步策略设置成 "always" 或者 "everysec"，并且后台的存储进程（后台存储或写入AOF</span>
<span class="token comment"># 日志）会产生很多磁盘I/O开销。某些Linux的配置下会使Redis因为 fsync()系统调用而阻塞很久。</span>
<span class="token comment"># 注意，目前对这个情况还没有完美修正，甚至不同线程的 fsync() 会阻塞我们同步的write(2)调用。</span>
<span class="token comment">#</span>
<span class="token comment"># 为了缓解这个问题，可以用下面这个选项。它可以在 BGSAVE 或 BGREWRITEAOF 处理时阻止fsync()。</span>
<span class="token comment"># </span>
<span class="token comment"># 这就意味着如果有子进程在进行保存操作，那么Redis就处于"不可同步"的状态。</span>
<span class="token comment"># 这实际上是说，在最差的情况下可能会丢掉30秒钟的日志数据。（默认Linux设定）</span>
<span class="token comment"># </span>
<span class="token comment"># 如果把这个设置成"yes"带来了延迟问题，就保持"no"，这是保存持久数据的最安全的方式。</span>

no-appendfsync-on-rewrite no

<span class="token comment"># 自动重写AOF文件</span>
<span class="token comment"># 如果AOF日志文件增大到指定百分比，Redis能够通过 BGREWRITEAOF 自动重写AOF日志文件。</span>
<span class="token comment"># </span>
<span class="token comment"># 工作原理：Redis记住上次重写时AOF文件的大小（如果重启后还没有写操作，就直接用启动时的AOF大小）</span>
<span class="token comment"># </span>
<span class="token comment"># 这个基准大小和当前大小做比较。如果当前大小超过指定比例，就会触发重写操作。你还需要指定被重写</span>
<span class="token comment"># 日志的最小尺寸，这样避免了达到指定百分比但尺寸仍然很小的情况还要重写。</span>
<span class="token comment">#</span>
<span class="token comment"># 指定百分比为0会禁用AOF自动重写特性。</span>

auto-aof-rewrite-percentage <span class="token number">100</span>
auto-aof-rewrite-min-size 64mb

<span class="token comment">################################ LUA SCRIPTING  ###############################</span>

<span class="token comment"># Lua 脚本的最大执行时间，毫秒为单位</span>
<span class="token comment">#</span>
<span class="token comment"># 如果达到了最大的执行时间，Redis将要记录在达到最大允许时间之后一个脚本仍然在执行，并且将</span>
<span class="token comment"># 开始对查询进行错误响应。</span>
<span class="token comment">#</span>
<span class="token comment"># 当一个长时间运行的脚本超过了最大执行时间，只有 SCRIPT KILL 和 SHUTDOWN NOSAVE 两个</span>
<span class="token comment"># 命令可用。第一个可以用于停止一个还没有调用写命名的脚本。第二个是关闭服务器唯一方式，当</span>
<span class="token comment"># 写命令已经通过脚本开始执行，并且用户不想等到脚本的自然终止。</span>
<span class="token comment">#</span>
<span class="token comment"># 设置成0或者负值表示不限制执行时间并且没有任何警告</span>
lua-time-limit <span class="token number">5000</span>

<span class="token comment">################################## SLOW LOG ###################################</span>

<span class="token comment"># Redis慢查询日志可以记录超过指定时间的查询。运行时间不包括各种I/O时间，例如：连接客户端，</span>
<span class="token comment"># 发送响应数据等，而只计算命令执行的实际时间（这只是线程阻塞而无法同时为其他请求服务的命令执</span>
<span class="token comment"># 行阶段）</span>
<span class="token comment"># </span>
<span class="token comment"># 你可以为慢查询日志配置两个参数:一个指明Redis的超时时间(单位为微秒)来记录超过这个时间的命令</span>
<span class="token comment"># 另一个是慢查询日志长度。当一个新的命令被写进日志的时候，最老的那个记录从队列中移除。</span>
<span class="token comment">#</span>
<span class="token comment"># 下面的时间单位是微秒，所以1000000就是1秒。注意，负数时间会禁用慢查询日志，而0则会强制记录</span>
<span class="token comment"># 所有命令。</span>
slowlog-log-slower-than <span class="token number">10000</span>

<span class="token comment"># 这个长度没有限制。只是要主要会消耗内存。你可以通过 SLOWLOG RESET 来回收内存。</span>
slowlog-max-len <span class="token number">128</span>

<span class="token comment">############################# Event notification ##############################</span>

<span class="token comment"># Redis 能通知 Pub/Sub 客户端关于键空间发生的事件</span>
<span class="token comment"># 这个功能文档位于http://redis.io/topics/keyspace-events</span>
<span class="token comment">#</span>
<span class="token comment"># 例如：如果键空间事件通知被开启，并且客户端对 0 号数据库的键 foo 执行 DEL 命令时，将通过</span>
<span class="token comment"># Pub/Sub发布两条消息：</span>
<span class="token comment"># PUBLISH __keyspace@0__:foo del</span>
<span class="token comment"># PUBLISH __keyevent@0__:del foo</span>
<span class="token comment">#</span>
<span class="token comment"># 可以在下表中选择Redis要通知的事件类型。事件类型由单个字符来标识：</span>
<span class="token comment">#</span>
<span class="token comment"># K    键空间通知，以__keyspace@&lt;db&gt;__为前缀</span>
<span class="token comment"># E    键事件通知，以__keysevent@&lt;db&gt;__为前缀</span>
<span class="token comment"># g    DEL , EXPIRE , RENAME 等类型无关的通用命令的通知, ...</span>
<span class="token comment"># $    String命令</span>
<span class="token comment"># l    List命令</span>
<span class="token comment"># s    Set命令</span>
<span class="token comment"># h    Hash命令</span>
<span class="token comment"># z    有序集合命令</span>
<span class="token comment"># x    过期事件（每次key过期时生成）</span>
<span class="token comment"># e    驱逐事件（当key在内存满了被清除时生成）</span>
<span class="token comment"># A    g$lshzxe的别名，因此”AKE”意味着所有的事件</span>
<span class="token comment">#</span>
<span class="token comment"># notify-keyspace-events 带一个由0到多个字符组成的字符串参数。空字符串意思是通知被禁用。</span>
<span class="token comment">#</span>
<span class="token comment"># 例子：启用List和通用事件通知：</span>
<span class="token comment"># notify-keyspace-events Elg</span>
<span class="token comment">#</span>
<span class="token comment"># 例子2：为了获取过期key的通知订阅名字为 __keyevent@__:expired 的频道，用以下配置</span>
<span class="token comment"># notify-keyspace-events Ex</span>
<span class="token comment">#</span>
<span class="token comment"># 默认所用的通知被禁用，因为用户通常不需要该特性，并且该特性会有性能损耗。</span>
<span class="token comment"># 注意如果你不指定至少K或E之一，不会发送任何事件。</span>
notify-keyspace-events <span class="token string">""</span>

<span class="token comment">############################### ADVANCED CONFIG ###############################</span>

<span class="token comment"># 当hash只有少量的entry时，并且最大的entry所占空间没有超过指定的限制时，会用一种节省内存的</span>
<span class="token comment"># 数据结构来编码。可以通过下面的指令来设定限制</span>
hash-max-ziplist-entries <span class="token number">512</span>
hash-max-ziplist-value <span class="token number">64</span>

<span class="token comment"># 与hash似，数据元素较少的list，可以用另一种方式来编码从而节省大量空间。</span>
<span class="token comment"># 这种特殊的方式只有在符合下面限制时才可以用：</span>
list-max-ziplist-entries <span class="token number">512</span>
list-max-ziplist-value <span class="token number">64</span>

<span class="token comment"># set有一种特殊编码的情况：当set数据全是十进制64位有符号整型数字构成的字符串时。</span>
<span class="token comment"># 下面这个配置项就是用来设置set使用这种编码来节省内存的最大长度。</span>
set-max-intset-entries <span class="token number">512</span>

<span class="token comment"># 与hash和list相似，有序集合也可以用一种特别的编码方式来节省大量空间。</span>
<span class="token comment"># 这种编码只适合长度和元素都小于下面限制的有序集合：</span>
zset-max-ziplist-entries <span class="token number">128</span>
zset-max-ziplist-value <span class="token number">64</span>

<span class="token comment"># HyperLogLog sparse representation bytes limit. The limit includes the</span>
<span class="token comment"># 16 bytes header. When an HyperLogLog using the sparse representation crosses</span>
<span class="token comment"># this limit, it is converted into the dense representation.</span>
<span class="token comment">#</span>
<span class="token comment"># A value greater than 16000 is totally useless, since at that point the</span>
<span class="token comment"># dense representation is more memory efficient.</span>
<span class="token comment"># </span>
<span class="token comment"># The suggested value is ~ 3000 in order to have the benefits of</span>
<span class="token comment"># the space efficient encoding without slowing down too much PFADD,</span>
<span class="token comment"># which is O(N) with the sparse encoding. The value can be raised to</span>
<span class="token comment"># ~ 10000 when CPU is not a concern, but space is, and the data set is</span>
<span class="token comment"># composed of many HyperLogLogs with cardinality in the 0 - 15000 range.</span>
hll-sparse-max-bytes <span class="token number">3000</span>

<span class="token comment"># 启用哈希刷新，每100个CPU毫秒会拿出1个毫秒来刷新Redis的主哈希表（顶级键值映射表）。</span>
<span class="token comment"># redis所用的哈希表实现（见dict.c）采用延迟哈希刷新机制：你对一个哈希表操作越多，哈希刷新</span>
<span class="token comment"># 操作就越频繁；反之，如果服务器是空闲的，那么哈希刷新就不会完成，哈希表就会占用更多的一些</span>
<span class="token comment"># 内存而已。</span>
<span class="token comment"># </span>
<span class="token comment"># 默认是每秒钟进行10次哈希表刷新，用来刷新字典，然后尽快释放内存。</span>
<span class="token comment">#</span>
<span class="token comment"># 建议：</span>
<span class="token comment"># 如果你对延迟比较在意，不能够接受Redis时不时的对请求有2毫秒的延迟的话，就用</span>
<span class="token comment"># "activerehashing no"，如果不太在意延迟而希望尽快释放内存就设置"activerehashing yes"</span>
activerehashing <span class="token function">yes</span>

<span class="token comment"># 客户端的输出缓冲区的限制，可用于强制断开那些因为某种原因从服务器读取数据的速度不够快的客户端，</span>
<span class="token comment"># （一个常见的原因是一个发布/订阅客户端消费消息的速度无法赶上生产它们的速度）</span>
<span class="token comment">#</span>
<span class="token comment"># 可以对三种不同的客户端设置不同的限制：</span>
<span class="token comment"># normal -&gt; 正常客户端</span>
<span class="token comment"># slave -&gt; slave和 MONITOR 客户端</span>
<span class="token comment"># pubsub -&gt; 至少订阅了一个pubsub channel或pattern的客户端</span>
<span class="token comment">#</span>
<span class="token comment"># 下面是每个client-output-buffer-limit语法:</span>
<span class="token comment"># client-output-buffer-limit &lt;class&gt;&lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;</span>

<span class="token comment"># 一旦达到硬限制客户端会立即被断开，或者达到软限制并持续达到指定的秒数（连续的）。</span>
<span class="token comment"># 例如，如果硬限制为32兆字节和软限制为16兆字节/10秒，客户端将会立即断开</span>
<span class="token comment"># 如果输出缓冲区的大小达到32兆字节，或客户端达到16兆字节并连续超过了限制10秒，就将断开连接。</span>
<span class="token comment">#</span>
<span class="token comment"># 默认normal客户端不做限制，因为他们在不主动请求时不接收数据（以推的方式），只有异步客户端</span>
<span class="token comment"># 可能会出现请求数据的速度比它可以读取的速度快的场景。</span>
<span class="token comment">#</span>
<span class="token comment"># pubsub和slave客户端会有一个默认值，因为订阅者和slaves以推的方式来接收数据</span>
<span class="token comment">#</span>
<span class="token comment"># 把硬限制和软限制都设置为0来禁用该功能</span>
client-output-buffer-limit normal <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>
client-output-buffer-limit slave 256mb 64mb <span class="token number">60</span>
client-output-buffer-limit pubsub 32mb 8mb <span class="token number">60</span>

<span class="token comment"># Redis调用内部函数来执行许多后台任务，如关闭客户端超时的连接，清除未被请求过的过期Key等等。</span>
<span class="token comment">#</span>
<span class="token comment"># 不是所有的任务都以相同的频率执行，但Redis依照指定的“hz”值来执行检查任务。</span>
<span class="token comment">#</span>
<span class="token comment"># 默认情况下，“hz”的被设定为10。提高该值将在Redis空闲时使用更多的CPU时，但同时当有多个key</span>
<span class="token comment"># 同时到期会使Redis的反应更灵敏，以及超时可以更精确地处理。</span>
<span class="token comment">#</span>
<span class="token comment"># 范围是1到500之间，但是值超过100通常不是一个好主意。</span>
<span class="token comment"># 大多数用户应该使用10这个默认值，只有在非常低的延迟要求时有必要提高到100。</span>
hz <span class="token number">10</span>

<span class="token comment"># 当一个子进程重写AOF文件时，如果启用下面的选项，则文件每生成32M数据会被同步。为了增量式的</span>
<span class="token comment"># 写入硬盘并且避免大的延迟高峰这个指令是非常有用的</span>
aof-rewrite-incremental-fsync <span class="token function">yes</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">juhaozero</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://juhaozero.github.io/posts/705c1a66.html">https://juhaozero.github.io/posts/705c1a66.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">juhaozero</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/%E5%85%B6%E4%BB%96/"><span class="chip bg-color">其他</span> </a><a href="/tags/%E6%97%A5%E5%B8%B8/"><span class="chip bg-color">日常</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"></div></div></div></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/705c1a66.html"><div class="card-image"><img src="/medias/featureimages/19.jpg" class="responsive-img" alt="一些网站和其他"> <span class="card-title">一些网站和其他</span></div></a><div class="card-content article-content"><div class="summary block-with-text">🎶</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2023-01-17 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%85%B6%E4%BB%96/" class="post-category">其他</a></span></div></div><div class="card-action article-tags"><a href="/tags/%E5%85%B6%E4%BB%96/"><span class="chip bg-color">其他</span> </a><a href="/tags/%E6%97%A5%E5%B8%B8/"><span class="chip bg-color">日常</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/5fddf106.html"><div class="card-image"><img src="/medias/featureimages/11.jpg" class="responsive-img" alt="Git常用命令"> <span class="card-title">Git常用命令</span></div></a><div class="card-content article-content"><div class="summary block-with-text">(╯°□°）╯︵ ┻━┻</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2021-08-12 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Git/" class="post-category">Git</a></span></div></div><div class="card-action article-tags"><a href="/tags/Git/"><span class="chip bg-color">Git</span></a></div></div></div></div></article></div><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff;overflow-y:scroll;height:400px"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h1, h2, h3, h4, h5"});let t=0,e="toc-heading-";$("#toc-content a").each(function(){$(this).attr("href","#"+e+ ++t)}),t=0,$("#articleContent").children("h1, h2, h3, h4, h5").each(function(){$(this).attr("id",e+ ++t)});let n=parseInt(.4*$(window).height()-64),o=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>n?o.addClass("toc-fixed"):o.removeClass("toc-fixed")});const i="expanded";let c=$("#toc-aside"),l=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){c.hasClass(i)?(c.removeClass(i).hide(),l.removeClass("l9")):(c.addClass(i).show(),l.addClass("l9")),function(t,e){let n=$("#"+t);if(0!==n.length){let t=n.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+e).width(t)}}("artDetail","prenext-posts")})})</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020-2023</span> <a href="/about" target="_blank">juhaozero</a> |&nbsp;<span style="margin:0 5px;display:inline-block"><i class="fa fa-heart" style="color:#ff71a8"></i></span> Powered by <a href="/about" target="_blank">juhaozero</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">21.6k</span>&nbsp;字<br><br></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/juhaozero" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:602994954@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=602994954" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 602994954" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script type="text/javascript">$(function(){!function(t,r,s){"use strict";$.ajax({url:t,dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),t=document.getElementById(r),n=document.getElementById(s);t.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(e.forEach(function(t){var n,e,r,s=!0,i=t.title.trim().toLowerCase(),l=t.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),a=0===(a=t.url).indexOf("/")?t.url:"/"+a,c=-1,u=-1;""!==i&&""!==l&&h.forEach(function(t,e){n=i.indexOf(t),c=l.indexOf(t),n<0&&c<0?s=!1:(c<0&&(c=0),0===e&&(u=c))}),s&&(o+="<li><a href='"+a+"' class='search-result-title'>"+i+"</a>",e=t.content.trim().replace(/<[^>]+>/g,""),0<=u&&(a=u+80,(a=0===(t=(t=u-20)<0?0:t)?100:a)>e.length&&(a=e.length),r=e.substr(t,a),h.forEach(function(t){var e=new RegExp(t,"gi");r=r.replace(e,'<em class="search-keyword">'+t+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})}("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="https://cdn.bootcss.com/materialize/1.0.0/js/materialize.min.js"></script><script src="https://cdn.bootcss.com/masonry/4.2.2/masonry.pkgd.min.js"></script><script src="https://cdn.bootcss.com/aos/3.0.0-beta.6/aos.js"></script><script src="https://cdn.bootcss.com/scrollprogress/3.0.2/scrollProgress.min.js"></script><script src="https://cdn.bootcss.com/lightgallery/1.6.12/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="/libs/others/clicklove.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginModelPath:"assets/",model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:300,height:250},mobile:{show:!1},rect:"opacity:0.7",log:!1,pluginJsPath:"lib/",pluginRootPath:"live2dw/",tagMode:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>